// #仪表盘


// 自动发现状态
// 请求：
action: discovery/getStatus
// 返回
{
    "data": {
        "missionIng": 10,
        "missionPlan": 20,
        "missoneLately": [{
            "name": "发现物理设备",
            "status": 1,
            "endTime": "2018-01-10 13:26:36",
            "discoveried":14,
            "missionId":1
        }, {
            "name": "发现中间件",
            "status": 1,
            "endTime": "2018-01-10 13:30:36",
            "discoveried":10,
            "missionId":2
        }, {
            "name": "发现数据库",
            "status": 1,
            "endTime": "2018-01-10 13:35:36",
            "discoveried":10,
            "missionId":3
        }]
    },
    "success": true,
    "msg": "成功"
}


// CMDB 同步状态

// 请求
action: discovery/sync
{
    "data": [{
        "info": "进行CMDB同步，同步失败",
        "startTime": "2018-3-5 10:11:14"
    }, {
        "info": "CMDB倒计时同步",
        "startTime": "2018-3-5 16:11:14"
    }, {
        "info": "进行CMDB同步，同步失败",
        "startTime": "2018-2-5 10:11:14"
    }, {
        "info": "进行CMDB同步，同步失败",
        "startTime": "2018-2-5 10:11:14"
    }, {
        "info": "进行CMDB同步，同步失败",
        "startTime": "2018-2-5 10:11:14"
    }],
    "success": true,
    "msg": "成功"
}

// 快速访问
action:  discovery/getCategoryInfo
{
    "data": [{
        "typeCode": "server",
        "sum": 33
    }, {
        "typeCode": "db",
        "sum": 1284
    }, {
        "typeCode": "middleware",
        "sum": 1001
    }, {
        "typeCode": "cloud",
        "sum": 4
    }, {
        "typeCode": "network",
        "sum": 4
    }, {
        "typeCode": "app",
        "sum": 1001
    }],
    "success": true,
    "msg": "成功"
}

// 新特征
action:  discovery/getVersionNEWS
{
    "data": {
        "version": "1.0",
        "features":[{
            "title":"自动发现网络环境中的IT资源",
            "info":["系统支持自动发现网络环境中的网络设备、服务器、存储、数据库、中间件和应用程序等IT资源"]
        },{
            "title":"自动发现IT资源的部署信息和运行信息",
            "info":["系统支持自动发现IT资源的部署信息和运行信息"]
        },{
            "title":"自动发现IT资源的关联关系",
            "info":["系统支持自动发现IT资源的关联关系，包括部署层级关系，物理连接关系，数据通信关系"]
        },{
            "title":"提供Restful外部接口",
            "info":["系统对外提供Restful接口，供CMDB系统同步IT资源的部署、运行和关联关系信息","同步某类IT资源简要信息","同步某个IT资源的详细信息","同步指定时间开始发现的IT资源信息"]
        },{
            "title":"可视化IT资源的拓扑关系",
            "info":["系统从应用系统的视角，向用户可视化展示IT资源的拓扑关系"]
        }]
    },
    "success": true,
    "msg": "成功"
}




// #自动发现配置

// SNMP设备发现策略
action：  strategy/SNMPInfo
请求
{
    "limit":20,
    "offset":60,
    "order":"asc",
    "searchText":""
}
{
    "total":14,
    "rows": [{
        "id": 1,
        "name": "SNMP发现策略",
        "port": 161,
        "protVersion":"v1",
        "RGroupName":"public"
    },{
        "id": 1,
        "name": "SNMP发现策略",
        "port": 164,
        "protVersion":"v3",
        "RGroupName":"public"
    },{
        "id": 1,
        "name": "SNMP发现策略",
        "port": 162,
        "protVersion":"v4",
        "RGroupName":"public"
    }]
}

action：  strategy/saveSNMP
请求
{
    // id 为 null 则 为新增
    "id": 1,
    "name": "SNMP发现策略",
    "port": 161,
    "protVersion": "v1/v2",
    "rGroupName": "public",
    "safeName":"",
    "engineId":"",
    "signatureProt":"",
    "signaturePassw":"",
    "encryptProt":"",
    "encryptPassw":""
}
{
    "data": {
        "id":1
    },
    "success": true,
    "msg": "成功"
}


action：  strategy/delSNMP
请求
{
    "ids": [1,2,3],
}
{
    "data": {},
    "success": true,
    "msg": "成功"
}


// 端口发现策略
action：  strategy/portAll
请求
{
    // 1: 标准的  2：客户化端口
    "portType":1 ,
    // type == 2 才有下面这三项
    "limit":20,
    "offset":60,
    "order":"asc",
    "searchText":""
}
{
    "total":100,
    "rows": [{
        "id": 1,
        "appName": "FTP",
        "ports": [161]
    },{
        "id": 2,
        "appName": "FTP1",
        "ports": [162]
    },{
        "id": 3,
        "appName": "FTP2",
        "ports": [163,144]
    }]
}

action：  strategy/defPort
请求
{
    // 1: 标准的  2：客户化端口
    "portType":1,
    "name":"Window RPC",
    "ports":[135,188],
    // id 为null 则是客户端的新增
    "id":1
}
{
    "data": {
        "id":1
    },
    "success": true,
    "msg": "成功"
}

action：  strategy/delPort
请求
{
    "ids": [1,2,3],
    "portType":2
}
{
    "data": {},
    "success": true,
    "msg": "成功"
}


// 服务器设备发现策略
action：  strategy/serverAll
请求
{
    "limit":20,
    "offset":60,
    "order":"asc",
    "searchText":""
}
{
    "total":10,
    "rows": [{
        "id": 1,
        "name": "服务器发现策略",
        "prot": "window",
        "account":"administrator",
        "encoding":"GBK",
        "port":15
    },{
        "id": 2,
        "name": "发现策略",
        "prot": "linux",
        "account":"admin",
        "encoding":"utf",
        "port":16
    }]
}

action：  strategy/saveServer
请求
{
    // id 为null 则是新增
    "id": 1,
    "name": "服务器发现策略",
    "prot": "window",
    "port":151,
    "account":"administrator",
    "password":"",
    "domain":"digitalchina.com",
    "encoding":"GBK",
    "echo":"sdf"
}
{
    "data": {
        "id":1
    },
    "success": true,
    "msg": "成功"
}


action：  strategy/delServer
请求
{
    "ids": [1,2,3]
}
{
    "data": {},
    "success": true,
    "msg": "成功"
}


// 云环境设备发现策略
action：  strategy/cloudAll
请求
{
    "limit": 20,
    "offset": 60,
    "order":"asc",
    "searchText":""
}
{
    "total":55,
    "rows": [{
        "id": 1,
        "name": "服务器发现策略",
        "address": "10.4.4.201",
        "account":"administrator"
    },{
        "id": 2,
        "name": "服务器发现策略",
        "address": "10.0.220.201",
        "account":"admin"
    }]
}

action：  strategy/saveCloud
请求
{
    // id 为null 则是新增
    "id": 1,
    "name": "服务器发现策略",
    "domainType": "vmware",
    "domainIp":"",
    "account":"administrator",
    "password":""
}
{
    "data": {
        "id":1
    },
    "success": true,
    "msg": "成功"
}


action：  strategy/delCloud
请求
{
    "ids": [1,2,3]
}
{
    "data": {},
    "success": true,
    "msg": "成功"
}


// 数据库设备发现策略
action：  strategy/dbAll
请求
{
    "limit": 20,
    "offset": 60,
    "order":"asc",
    "searchText":""
}
{
    "total":55,
    "rows": [{
        "id": 1,
        "name": "数据库发现策略",
        "dbType":"Oracle",
        "connectType":"服务名",
        "dbName": "auto4_4",
        "port":"1433",
        "account":"root",
        "password":234,
        "encoding":"gbk"
    },{
        "id": 2,
        "name": "数据库发现策略",
        "dbType":"Oracle",
        "connectType":"实例名",
        "dbName": "auto1",
        "port":"1433",
        "account":"root",
        "password":234,
        "encoding":"utf8"
    },{
        "id": 3,
        "name": "数据库发现策略",
        "dbType":"DB2",
        "connectType":"实例名",
        "dbName": "auto1",
        "port":"1433",
        "account":"root",
        "password":234,
        "encoding":"utf8"
    }]
}

action：  strategy/saveDB
请求
{
    // id 为null 则是新增
    "id": 1,
    "name": "数据库发现策略",
    "dbType": "Oracle",
    "connectType": "服务名",
    "dbName": "auto4_4",
    "port": "1433",
    "account": "root",
    "password": 234,
    "encoding": "gbk"
}
{
    "data": {
        "id":1
    },
    "success": true,
    "msg": "成功"
}


action：  strategy/delDB
请求
{
    "ids": [1,2,3]
}
{
    "data": {},
    "success": true,
    "msg": "成功"
}

// 中间件设备发现策略
action：  strategy/midwareAll
请求
{
    "limit": 20,
    "offset": 60,
    "order":"asc",
    "searchText":""
}
{
    "total":55,
    "rows": [{
        "id": 1,
        "name": "中间件发现策略1",
        "OSType": "Tomcat",
        "port": "8080",
        "soapPort": 0000,
        "account": "admin"
    }]
}

action：  strategy/saveMidware
请求
{
    // id 为null 则是新增
    "id": 1,
    "name": "中间件发现策略1",
    "OSType":"Tomcat",
    "port":"8080",
    "soapPort":0000,
    "account":"admin",
    "password":"123"
}
{
    "data": {
        "id":1
    },
    "success": true,
    "msg": "成功"
}


action：  strategy/delMidware
请求
{
    "ids": [1,2,3]
}
{
    "data": {},
    "success": true,
    "msg": "成功"
}


// 发现任务发现策略
// 
// 策略Type：物理设备 1 ；端口2 ：服务器3  ；云 4  数据库 5 ，中间件6
action：  strategy/missionAll
请求
{
    "limit": 20,
    "offset": 60,
    "order":"asc",
    "searchText":""
}
{
    "total":77,
    "rows": [{
        "id": 1,
        "name": "中间件发现策略1",
        "content":"server,db",
        "schedule":["每天九点","下午三点"],
        "scheduleId":"2,3,4",
        "ips":[{
            "type":"指定IP",
            "value":"10.5.5.53"
        },{
            "type":"IP地址段",
            "value":"10.5.5.54-10.5.5.65"
        },{
            "type":"CIDR",
            "value":"10.5.5.54/9"
        }]
    }]
}

action: strategy/getSchedule
{
    "data": [{
        "id": 1,
        "text": "Option 1"
    }, {
        "id": 2,
        "text": "Option 2"
    }, {
        "id": 3,
        "text": "Option 3"
    }],
    "success":true,
    "msg":""
}

action：  strategy/saveMission
请求
{
    // id 为null 则是新增
    "id": 1,
    "name": "中间件发现策略1",
    "content": "1,2,3",
    "scheduleId": "2,3,4",
    "ips": [{
        "type": "指定ip",
        "value": "10.5.5.53"
    }, {
        "type": "IP地址段",
        "value": "10.5.5.54-10.5.5.65"
    }, {
        "type": "CIDR",
        "value": "10.5.5.54/9"
    }]
}
{
    "data": {
        "id":1
    },
    "success": true,
    "msg": "成功"
}


action：  strategy/delMission
请求
{
    "ids": [1,2,3]
}
{
    "data": {},
    "success": true,
    "msg": "成功"
}

action： strategy/agentAll
{}
{
    "total":77,
    "rows": [{
        "id": 1,
        "name": "YOUJF-DCITSTEST001",
        "ip":"10.5.5.80",
        "OS":"Linux",
        "status":"在线",
        "agentVersion":"5.0.0"
    }]
}


action：  strategy/delAgent
请求
{
    "ids": [1,2,3]
}
{
    "data": {},
    "success": true,
    "msg": "成功"
}

action： strategy/getAgents
{
    "data": [{
        "id": 1,
        "text": "10.5.5.1"
    }, {
        "id": 2,
        "text": "10.5.5.2"
    }, {
        "id": 3,
        "text": "10.5.5.3"
    }],
    "success":true,
    "msg":""
}

action : strategy/addAgent
{
    "ids":[1]
}
{
    "data": {},
    "success": true,
    "msg": "成功"
}


// # 自动发现监控
// 正在扫描 1  ；扫描完成 2 ； 计划扫描 3 ； 全部 4
//策略Type 物理设备 1 ；端口2 ：服务器3  ；云 4  数据库 5 ，中间件6

action：  monitor/infoAll
请求
{
    "limit": 20,
    "offset": 60,
    "order":"asc",
    "searchText":"",
    "monitorType":1
}
{
    "total": 180,
    "rows": [{
        "id": 1,
        "name": "扫描任务1",
        "content": "server,db",
        "schedule": ["每天九点", "下午三点"],
        "scheduleId": "2,3,4",
        "startTime": "2018-01-10 09:00:00",
        "endTime": "2018-01-10 10:00:00",
        "operator": "系统",
        "status": 1,
        "progress":40
    },{
        "id": 2,
        "name": "扫描任务1",
        "content": "server,db",
        "schedule": ["每天九点", "下午三点"],
        "scheduleId": "2,3,4",
        "startTime": "2018-01-10 09:00:00",
        "endTime": "2018-01-10 10:00:00",
        "operator": "系统",
        "status": 2,
        "progress":100
    },{
        "id": 3,
        "name": "扫描任务1",
        "content": "server,db",
        "schedule": ["每天九点", "下午三点"],
        "scheduleId": "2,3,4",
        "startTime": "2018-01-10 09:00:00",
        "endTime": "2018-01-10 10:00:00",
        "operator": "系统",
        "status": 3,
        "progress":0
    }]
}

action：  monitor/detail
请求
{
    "id":1
}
{
    "data": {
        "name": "WIN-0ECQ6MI24DJ",
        "contentInfo": [{
            "typeCode": "server",
            "sum": 33
        }, {
            "typeCode": "db",
            "sum": 1284
        }, {
            "typeCode": "middleware",
            "sum": 1001
        }, {
            "typeCode": "cloud",
            "sum": 4
        }, {
            "typeCode": "network",
            "sum": 4
        }, {
            "typeCode": "app",
            "sum": 1001
        }],
        "details": [{
            "keyText": "开始时间",
            "value": "2018-01-10 09:00:00",
            "isText": true
        }, {
            "keyText": "扫描进度",
            "value": 40,
            "isProcess": true
        }, {
            "keyText": "补丁",
            "value": {
                "columnsText": ["服务器名", "IP地址", "OS类型", "OS版本","数量","发布者","新内容1","新内容2","新内容3"],
                "tableData": [[
                    "##IANGDL",
                    "10.5.5.175",
                    "Linux",
                    "Redhat Enterprise 15.5 Santago",
                    15,
                    "sher",
                    "新内容11",
                    "新内容22",
                    "新内容33"
                ],[
                    "LIGDL",
                    "10.5.5.175",
                    "Lin x",
                    "Redhat Enterprise 6115 Santago",
                    20,
                    "lock",
                    "新内容44",
                    "新内容55",
                    "新内容66"
                ],[
                    "L DL",
                    "10.5.5.175",
                    "Lux",
                    "Redhat Enterprise 4.5 Santago",
                    24,
                    "lockss",
                    "新内容11",
                    "新内容22",
                    "新内容33"
                ]]
            },
            "isTable": true
        }]
    },
    "success": true,
    "msg": "成功"
}


action：  monitor/startScan
请求
{
    "ids":[1,2,3]
}
{
    "data":{},
    "success": true,
    "msg": "成功"
}

action：  monitor/stopScan
请求
{
    "ids":[1,2,3]
}
{
    "data": [],
    "success": true,
    "msg": "成功"
}

// # IT资源信息
//资源type  
// {type:'server',',text:'服务器'},
// {type:'db',',text:'数据库'},
// {type:'middleware,text:'中间件'},
// {type:'cloud,text:'Vmware云环境'},
// {type:'network,text:'网络设备'},
// {type:'app,text:'应用程序'}

action：  ITSource/getTags
请求
{
    // types : 现阶段是数组为1，以下是查出服务器的id为1的资源的应用系统
    "types":[1],
    "ids":[1]
}
{
    "data": ["应用服务器","应用服务器1"],
    "success": true,
    "msg": "成功"
}

action：  ITSource/infoAll
请求
{
    "limit":20,
    "offset":60,
    "order":"asc",
    "searchText":"",
    "OSVer":"",
    "OSType":"",
    "serFac":"",
    "tags":[],
    "typeCode":"server"
}
{
    "total": 180,
    "rows": [{
        "name": "serv",
        "ip": "10.5.5.111",
        "OSType": "Linux",
        "OSVer": "Redhat Enterprise 1 Santago",
        "OSType":"OS类型",
        "serFac":"Dell",
        "tags":["应用系统1"],
        "id": 1
    }, {
        "name": "yery",
        "ip": "10.5.5.14",
        "OSType": "Linux",
        "OSVer": "Enterprise 2 Santago",
        "OSType":"OS类型",
        "serFac":"Dell",
        "tags":["应用系统2","应用系统3"],
        "id": 2
    }, {
        "name": "cc",
        "ip": "10.5.5.145",
        "OSType": "Linux",
        "OSVer": "Redhat Enterprise 4 Santago",
        "OSType":"OS类型",
        "serFac":"Dell",
        "tags":["应用系统2","应用系统3"],
        "id": 3
    }, {
        "name": "qqq",
        "ip": "10.5.5.13",
        "OSType": "Linux",
        "OSVer": "Redhat Enterprise 5 Santago",
        "OSType":"OS类型",
        "serFac":"Dell",
        "tags":["应用系统4","应用系统3"],
        "id": 4
    }, {
        "name": "ttt",
        "ip": "10.5.5.15",
        "OSType": "Linux",
        "OSVer": "Redhat Enterprise 6.5",
        "OSType":"OS类型",
        "serFac":"Dell",
        "tags":["应用系统5","应用系统3"],
        "id": 5
    }]
}

action：  ITSource/addServer
请求：
{
    "id": 1,
    "name": "设备名称",
    "ip":"10.4.4.1",
    "prot": "window",
    "port":151,
    "account":"administrator",
    "password":"",
    "domain":"digitalchina.com",
    "encoding":"GBK",
    "echo":"sdf"
}
{
    "data": {
        "id":1
    },
    "success": true,
    "msg": "成功"
}

action：  ITSource/detail
{
    "id":1,
    // "typeCode":1
}
{
    "data": {
        "name":"WIN-0ECQ6MI24DJ",
        "ip":"10.5.5.174",
        "tags":["应用服务器","数据库服务器"],
        "details":[{
            // "key":"startTime",
            "keyText":"开始时间",
            "value":"2018-01-10 09:00:00",
            "isText":true
        },{
            // "key":"scanProgress",
            "keyText":"扫描进度",
            "value":44,
            "isProcess":true
        },{
            "keyText":"补丁",
            "value":{
                // 如果超出五列就显示显示详情
                "columnsText": ["服务器名", "IP地址", "OS类型", "OS版本","数量","发布者","新内容1","新内容2","新内容3"],
                "tableData": [[
                    "##IANGDL",
                    "10.5.5.175",
                    "Linux",
                    "Redhat Enterprise 15.5 Santago",
                    15,
                    "sher",
                    "新内容11",
                    "新内容22",
                    "新内容33"
                ],[
                    "LIGDL",
                    "10.5.5.175",
                    "Lin x",
                    "Redhat Enterprise 6115 Santago",
                    20,
                    "lock",
                    "新内容44",
                    "新内容55",
                    "新内容66"
                ],[
                    "L DL",
                    "10.5.5.175",
                    "Lux",
                    "Redhat Enterprise 4.5 Santago",
                    24,
                    "lockss",
                    "新内容11",
                    "新内容22",
                    "新内容33"
                ]]
            },
            "isTable":true
        }]
    },
    "success": true,
    "msg": "成功"
}

// 获取应用系统，可能作为标签
action：  ITSource/getAllApp
{

}
{
    "data": [{
        "id":1,
        "text":"应用系统1"
    },{
        "id":2,
        "text":"应用系统2"
    },{
        "id":3,
        "text":"应用系统2"
    },{
        "id":4,
        "text":"应用系统2"
    }],
    "success": true,
    "msg": "成功"
}

action：  ITSource/getAppUsed
{

}
{
    "data": [{
        "id":1,
        "text":"应用系统1"
    },{
        "id":2,
        "text":"应用系统2"
    }],
    "success": true,
    "msg": "成功"
}

action：  ITSource/setTag
{
    "id":1,
    "typeCode":1,
    "tags":["应用服务器1","应用服务器2","应用服务器3"]
}
{
    "data": {},
    "success": true,
    "msg": "成功"
}


// IT 资源报表
//资源type  
// {type:'server',',text:'服务器'},
// {type:'db',',text:'数据库'},
// {type:'middleware,text:'中间件'},
// {type:'cloud,text:'Vmware云环境'},
// {type:'network,text:'网络设备'},
// {type:'app,text:'应用程序'}
action：  ITSourceReport/report
{

}
{
    "data": [{
        "typeCode": "network",
        "sum": 12,
        "details":[{
            "typeName":"SNMP设备",
            "sum":"10"
        },{
            "typeName":"其他设备",
            "sum":"2"
        }]
    }, {
        "typeCode": "db",
        "sum": 18,
        "details":[{
            "typeName":"Oracle",
            "sum":"3"
        },{
            "typeName":"Mysql",
            "sum":"4"
        },{
            "typeName":"DB2",
            "sum":"5"
        },{
            "typeName":"SQL Server",
            "sum":"6"
        }]
    }, {
        "typeCode": "middleware",
        "sum": 18,
        "details":[{
            "typeName":"Tomcat",
            "sum":"3"
        },{
            "typeName":"WebLogic",
            "sum":"6"
        },{
            "typeName":"Websphere",
            "sum":"9"
        }]
    }, {
        "typeCode": "cloud",
        "sum": 12,
        "details":[{
            "typeName":"vmware云环境",
            "sum":"12"
        }]
    }, {
        "typeCode": "network",
        "sum": 52,
        "details":[{
            "typeName":"Window",
            "sum":"30"
        },{
            "typeName":"Linux",
            "sum":"2"
        },{
            "typeName":"AIX",
            "sum":"10"
        },{
            "typeName":"HP-UX",
            "sum":"10"
        }]
    }, {
        "typeCode": "app",
        "sum": 1001,
        "details":[{
            "typeName":"应用程序",
            "sum":"12"
        }]
    }],
    "success": true,
    "msg": "成功"
}

// 资源报表统计
action：  ITSourceReport/count
{
    "typeName":"window"
}
{
    "data": [{
        "countType": 1,
        "details": [{
            "typeName": "HP",
            "sum": "5",
            "countType": 1
        }, {
            "typeName": "Dell",
            "sum": "5",
            "countType": 1
        }]
    }, {
        "countType": 2,
        "details": [{
            "typeName": "Windows Server 2008 SP2",
            "sum": "5",
            "countType": 2
        }, {
            "typeName": "Windows Server 2012 SP1",
            "sum": "5",
            "countType": 2
        }, {
            "typeName": "Windows Server 2012 SP2",
            "sum": 20,
            "countType": 2
        }]
    }, {
        "countType": 3,
        "details": [{
            "typeName": "应用服务器",
            "sum": "5",
            "countType": 3
        }, {
            "typeName": "数据库服务器",
            "sum": "5",
            "countType": 3
        }, {
            "typeName": "灾备服务器",
            "sum": "5",
            "countType": 3
        }, {
            "typeName": "邮件服务器",
            "sum": "5",
            "countType": 3
        }]
    }],
    "success": true,
    "msg": "成功"
}

// IT资源拓扑图
//资源type  
// {type:'server',',text:'服务器'},
// {type:'db',',text:'数据库'},
// {type:'middleware,text:'中间件'},
// {type:'cloud,text:'Vmware云环境'},
// {type:'network,text:'网络设备'},
// {type:'app,text:'应用程序'}
// 
// 关系图 ： 0  ；部署关系图：1 ；通信关系图 ：2  ；物理连接关系图 ： 3
action：  ITSourceTopo/showTopo
{
    // 默认查所有存在发现内容的应用系统中的第一
    "app":1,
    "relation": 0
}
{
    "data": {
        "nodeDataArray":[{
            // md5  唯一鉴别的key，可用于前端的key
            "key":1234,
            // 父级的key,用于前端显示上下游关系
            "parent":456,
            "id":1,
            // 资源 type
            "typeCode":"server",
            // 节点的名字
            "name": "BMC Patrol Agent 10.7.00"
        }],
        "count":[{
            "typeCode":"server",
            "sum":3
        },{
            "typeCode":"db",
            "sum":1
        },{
            "typeCode":"cloud",
            "sum":7
        },{
            "typeCode":"middleware",
            "sum":6
        },{
            "typeCode":"app",
            "sum":1
        }]
    },
    "success": true,
    "msg": "成功"
}